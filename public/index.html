<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lua ã‚³ãƒ¼ãƒ‰ãƒ„ãƒ¼ãƒ« by YAJU</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Share+Tech+Mono&family=Noto+Sans+JP:wght@300;400;700&display=swap');
:root{
  --bg:#060810;--panel:#0d1117;
  --obf:#ff3c5a;--obf-glow:rgba(255,60,90,.5);
  --deobf:#00e5ff;--deobf-glow:rgba(0,229,255,.5);
  --text:#d0d8e8;--muted:#556070;--border:#1e2535;
}
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:'Noto Sans JP',sans-serif;background:var(--bg);color:var(--text);min-height:100vh;overflow-x:hidden}
body::before{content:'';position:fixed;inset:0;
  background-image:linear-gradient(rgba(0,229,255,.03) 1px,transparent 1px),
    linear-gradient(90deg,rgba(0,229,255,.03) 1px,transparent 1px);
  background-size:40px 40px;pointer-events:none;z-index:0}
.wrapper{position:relative;z-index:1;max-width:1000px;margin:0 auto;padding:28px 20px 60px}
/* â”€â”€ header â”€â”€ */
.site-header{text-align:center;margin-bottom:28px}
.site-title{font-family:'Share Tech Mono',monospace;font-size:clamp(20px,4vw,34px);
  letter-spacing:.12em;color:#fff;text-shadow:0 0 20px rgba(255,255,255,.25);margin-bottom:6px}
.site-sub{font-size:.82em;color:var(--muted);letter-spacing:.08em}
/* â”€â”€ server status â”€â”€ */
.server-status{display:flex;gap:12px;justify-content:center;margin-bottom:22px;flex-wrap:wrap}
.srv-badge{display:flex;align-items:center;gap:6px;background:var(--panel);
  border:1px solid var(--border);border-radius:20px;padding:5px 14px;font-size:.76em;
  font-family:'Share Tech Mono',monospace;color:var(--muted)}
.srv-dot{width:7px;height:7px;border-radius:50%;background:var(--muted);flex-shrink:0}
.srv-dot.ok{background:#4cff80;box-shadow:0 0 6px #4cff80}
.srv-dot.warn{background:#ff9800;box-shadow:0 0 6px #ff9800}
.srv-dot.err{background:var(--obf);box-shadow:0 0 6px var(--obf)}
/* â”€â”€ tab â”€â”€ */
.mode-selector{display:flex;background:var(--panel);border:1px solid var(--border);
  border-radius:10px;overflow:hidden;margin-bottom:30px;position:relative}
.mode-btn{flex:1;padding:18px 12px;border:none;background:transparent;color:var(--muted);
  font-family:'Share Tech Mono',monospace;font-size:clamp(13px,2.5vw,17px);letter-spacing:.1em;
  cursor:pointer;transition:all .3s;position:relative;z-index:1}
.mode-btn::after{content:'';position:absolute;inset:0;opacity:0;transition:opacity .3s}
.mode-btn.obf::after{background:linear-gradient(135deg,rgba(255,60,90,.12),transparent)}
.mode-btn.deobf::after{background:linear-gradient(135deg,rgba(0,229,255,.12),transparent)}
.mode-btn.active.obf{color:var(--obf);text-shadow:0 0 12px var(--obf-glow)}
.mode-btn.active.deobf{color:var(--deobf);text-shadow:0 0 12px var(--deobf-glow)}
.mode-btn.active::after{opacity:1}
.mode-divider{width:1px;background:var(--border);flex-shrink:0}
.mode-indicator{position:absolute;bottom:0;left:0;height:3px;width:50%;
  border-radius:3px 3px 0 0;transition:all .4s cubic-bezier(.4,0,.2,1)}
.mode-indicator.obf{background:var(--obf);box-shadow:0 0 12px var(--obf-glow)}
.mode-indicator.deobf{background:var(--deobf);box-shadow:0 0 12px var(--deobf-glow);left:50%}
/* â”€â”€ panels â”€â”€ */
.tool-panel{display:none}.tool-panel.active{display:block}
/* â”€â”€ card â”€â”€ */
.card{background:var(--panel);border:1px solid var(--border);border-radius:10px;
  padding:22px;margin-bottom:20px;position:relative;overflow:hidden}
.card::before{content:'';position:absolute;top:0;left:0;right:0;height:2px}
.obf-panel .card::before{background:linear-gradient(90deg,transparent,var(--obf),transparent)}
.deobf-panel .card::before{background:linear-gradient(90deg,transparent,var(--deobf),transparent)}
.card-label{font-family:'Share Tech Mono',monospace;font-size:.78em;letter-spacing:.14em;margin-bottom:14px}
.obf-panel .card-label{color:var(--obf)}
.deobf-panel .card-label{color:var(--deobf)}
/* â”€â”€ file â”€â”€ */
.file-btn{display:block;background:#0a0f18;color:#aaa;padding:14px;border-radius:6px;
  cursor:pointer;border:1px dashed var(--border);transition:.25s;text-align:center;
  font-size:.9em;margin-bottom:10px}
.obf-panel .file-btn:hover{border-color:var(--obf);color:var(--obf)}
.deobf-panel .file-btn:hover{border-color:var(--deobf);color:var(--deobf)}
.file-name{font-size:.8em;color:var(--muted);text-align:right;margin-bottom:8px}
input[type="file"]{display:none}
/* â”€â”€ textarea â”€â”€ */
textarea{width:100%;background:#060a10;color:#41e882;border:1px solid var(--border);
  border-radius:6px;font-family:'Share Tech Mono',monospace;padding:14px;
  resize:vertical;font-size:13px;line-height:1.6;transition:border-color .25s}
textarea:focus{outline:none}
.obf-panel textarea:focus{border-color:rgba(255,60,90,.4)}
.deobf-panel textarea:focus{border-color:rgba(0,229,255,.4)}
/* â”€â”€ range â”€â”€ */
.range-row{display:flex;align-items:center;gap:14px;margin:10px 0 4px}
input[type="range"]{flex:1;height:4px;border-radius:4px;background:var(--border);
  cursor:pointer;-webkit-appearance:none;appearance:none}
input[type="range"]::-webkit-slider-thumb{-webkit-appearance:none;width:16px;height:16px;
  border-radius:50%;cursor:pointer}
.obf-panel input[type="range"]{accent-color:var(--obf)}
.obf-panel input[type="range"]::-webkit-slider-thumb{background:var(--obf)}
.range-val{font-family:'Share Tech Mono',monospace;min-width:44px;text-align:right;color:var(--obf)}
/* â”€â”€ checks â”€â”€ */
.checks-grid{display:flex;flex-wrap:wrap;gap:10px 24px}
.chk-label{display:flex;align-items:center;gap:8px;cursor:pointer;font-size:.88em;color:#bbb;transition:color .2s}
.chk-label:hover{color:#fff}
.chk-label input{transform:scale(1.2)}
.obf-panel .chk-label input{accent-color:var(--obf)}
/* â”€â”€ info â”€â”€ */
.warn{background:rgba(255,152,0,.08);border-left:3px solid #ff9800;padding:10px 14px;
  border-radius:4px;font-size:.82em;color:#ffb74d;margin-top:8px}
.info-banner{background:rgba(0,229,255,.05);border:1px solid rgba(0,229,255,.15);
  border-radius:8px;padding:16px;margin-bottom:16px;font-size:.85em;line-height:1.8;color:#99d6e0}
.info-banner strong{color:var(--deobf)}
.info-banner code{font-family:'Share Tech Mono',monospace;background:rgba(0,229,255,.1);
  padding:1px 5px;border-radius:3px}
.lite-info{display:none;margin-top:10px;font-size:.82em;color:#80deea;padding:8px 12px;
  background:rgba(0,229,255,.07);border-left:3px solid var(--deobf);border-radius:4px}
/* â”€â”€ buttons â”€â”€ */
.main-btn{width:100%;padding:17px;border:none;border-radius:8px;
  font-family:'Share Tech Mono',monospace;font-size:clamp(14px,2.5vw,18px);
  letter-spacing:.1em;cursor:pointer;transition:.3s;margin-top:6px}
.main-btn:disabled{opacity:.4;cursor:not-allowed;transform:none!important}
.obf-panel .main-btn{background:linear-gradient(135deg,var(--obf),#b71c1c);color:#fff;
  box-shadow:0 4px 20px rgba(255,60,90,.35)}
.obf-panel .main-btn:not(:disabled):hover{transform:translateY(-2px);box-shadow:0 6px 24px rgba(255,60,90,.55)}
.deobf-panel .main-btn{background:linear-gradient(135deg,var(--deobf),#006064);color:#000;
  box-shadow:0 4px 20px rgba(0,229,255,.3)}
.deobf-panel .main-btn:not(:disabled):hover{transform:translateY(-2px);box-shadow:0 6px 24px rgba(0,229,255,.5)}
/* â”€â”€ progress â”€â”€ */
.progress-wrap{height:4px;background:#0a0f18;border-radius:4px;margin:14px 0;overflow:hidden;display:none}
.progress-fill{height:100%;width:0;border-radius:4px;transition:width .15s linear}
.obf-panel .progress-fill{background:var(--obf);box-shadow:0 0 8px var(--obf-glow)}
.deobf-panel .progress-fill{background:var(--deobf);box-shadow:0 0 8px var(--deobf-glow)}
/* â”€â”€ loader â”€â”€ */
.loader{border:3px solid #1e2535;border-top:3px solid var(--deobf);border-radius:50%;
  width:28px;height:28px;animation:spin 1s linear infinite;margin:10px auto;display:none}
@keyframes spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}
/* â”€â”€ status â”€â”€ */
.status-line{text-align:center;font-size:.9em;font-family:'Share Tech Mono',monospace;
  min-height:1.6em;padding:6px 0;letter-spacing:.06em}
/* â”€â”€ copy btn â”€â”€ */
.copy-btn{width:100%;margin-top:10px;padding:11px;border:none;border-radius:6px;
  font-family:'Share Tech Mono',monospace;font-size:.88em;letter-spacing:.08em;cursor:pointer;transition:.2s}
.obf-panel .copy-btn{background:#222c3a;color:#eee}
.obf-panel .copy-btn:hover{background:var(--obf);color:#fff}
.deobf-panel .copy-btn{background:#0a1e22;color:#eee}
.deobf-panel .copy-btn:hover{background:var(--deobf);color:#000}
/* â”€â”€ deobf method cards â”€â”€ */
.method-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(148px,1fr));gap:10px;margin-bottom:4px}
.method-card{background:#060a10;border:1px solid var(--border);border-radius:8px;
  padding:12px 14px;cursor:pointer;transition:all .2s;position:relative;user-select:none}
.method-card input{display:none}
.method-card.selected{border-color:var(--deobf);background:rgba(0,229,255,.06)}
.method-card.selected::after{content:'âœ“';position:absolute;top:8px;right:10px;
  color:var(--deobf);font-size:.85em;font-family:'Share Tech Mono',monospace}
.method-card-title{font-family:'Share Tech Mono',monospace;font-size:.82em;
  color:var(--deobf);margin-bottom:4px;letter-spacing:.05em}
.method-card-desc{font-size:.72em;color:var(--muted);line-height:1.4}
/* â”€â”€ step results â”€â”€ */
.step-results{margin-bottom:16px}
.step-results-label{font-family:'Share Tech Mono',monospace;font-size:.76em;color:var(--deobf);
  letter-spacing:.12em;margin-bottom:10px}
.step-item{background:#060a10;border:1px solid var(--border);border-radius:6px;margin-bottom:8px;overflow:hidden}
.step-item-header{display:flex;align-items:center;gap:10px;padding:9px 14px;cursor:pointer;
  background:rgba(0,229,255,.03);transition:background .15s}
.step-item-header:hover{background:rgba(0,229,255,.07)}
.step-badge{font-family:'Share Tech Mono',monospace;font-size:.7em;padding:2px 8px;
  border-radius:3px;flex-shrink:0}
.step-badge.ok{background:rgba(0,229,100,.15);color:#4cff80;border:1px solid rgba(0,229,100,.3)}
.step-badge.fail{background:rgba(255,60,90,.1);color:var(--obf);border:1px solid rgba(255,60,90,.3)}
.step-badge.warn{background:rgba(255,152,0,.1);color:#ff9800;border:1px solid rgba(255,152,0,.3)}
.step-name{font-family:'Share Tech Mono',monospace;font-size:.84em;color:var(--text)}
.step-meta{font-size:.75em;color:var(--muted);margin-left:auto;font-family:'Share Tech Mono',monospace}
.step-arrow{font-size:.75em;color:var(--muted);transition:transform .2s}
.step-item-body{padding:10px 14px;font-size:.8em;color:#99aacc;line-height:1.7;display:none;
  border-top:1px solid var(--border)}
.step-item-body.open{display:block}
/* â”€â”€ use-as-input btn â”€â”€ */
.use-as-input-btn{width:100%;margin-top:8px;padding:10px;border:1px dashed var(--border);
  border-radius:6px;background:transparent;color:var(--muted);font-family:'Share Tech Mono',monospace;
  font-size:.82em;cursor:pointer;transition:.2s}
.use-as-input-btn:hover{border-color:var(--deobf);color:var(--deobf)}
/* â”€â”€ prometheus card â”€â”€ */
.prometheus-hint{font-size:.76em;color:#556070;margin-top:10px;padding-top:10px;border-top:1px solid var(--border)}
.prometheus-hint span{color:#bb86fc}
select.styled-select{width:100%;background:#060a10;border:1px solid var(--border);
  color:var(--text);font-family:'Share Tech Mono',monospace;padding:10px 12px;border-radius:6px;
  font-size:.9em;outline:none;cursor:pointer}
select.styled-select:focus{border-color:#bb86fc}
/* â”€â”€ discord â”€â”€ */
.discord-btn{position:fixed;bottom:28px;right:28px;width:54px;height:54px;background:#5865F2;
  border-radius:50%;display:flex;align-items:center;justify-content:center;
  box-shadow:0 4px 16px rgba(88,101,242,.45);transition:.3s;text-decoration:none;z-index:100}
.discord-btn:hover{transform:translateY(-4px) scale(1.08)}
.discord-btn svg{width:28px;height:28px;fill:#fff}
small.hint{display:block;color:var(--muted);font-size:.78em;margin-top:5px}
::-webkit-scrollbar{width:6px}
::-webkit-scrollbar-track{background:#0a0f18}
::-webkit-scrollbar-thumb{background:#2a3550;border-radius:3px}
</style>
</head>
<body>
<div class="wrapper">
  <header class="site-header">
    <div class="site-title">[ LUA CODE TOOL :: YAJU ]</div>
    <div class="site-sub">OBFUSCATOR &amp; DEOBFUSCATOR</div>
  </header>

  <!-- ã‚µãƒ¼ãƒãƒ¼ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ -->
  <div class="server-status">
    <div class="srv-badge"><div class="srv-dot" id="dotLua"></div><span id="labelLua">Lua: ç¢ºèªä¸­...</span></div>
    <div class="srv-badge"><div class="srv-dot" id="dotPrometheus"></div><span id="labelPrometheus">Prometheus: ç¢ºèªä¸­...</span></div>
  </div>

  <!-- ã‚¿ãƒ–åˆ‡æ›¿ -->
  <div class="mode-selector">
    <button class="mode-btn obf active" id="btnModeObf">ğŸ”’ é›£èª­åŒ–</button>
    <div class="mode-divider"></div>
    <button class="mode-btn deobf" id="btnModeDeobf">ğŸ”“ è§£èª­ (Deobfuscator)</button>
    <div class="mode-indicator obf" id="modeIndicator"></div>
  </div>

  <!-- â•â• é›£èª­åŒ–ãƒ‘ãƒãƒ« â•â• -->
  <div class="tool-panel obf-panel active" id="panelObf">
    <div class="card">
      <div class="card-label">[ 01 ] IMPORT CODE</div>
      <label for="obfFileInput" class="file-btn">ğŸ“‚ ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠ (.lua / .txt)</label>
      <input type="file" id="obfFileInput" accept=".lua,.txt">
      <div id="obfFileName" class="file-name">ãƒ•ã‚¡ã‚¤ãƒ«æœªé¸æŠ</div>
      <textarea id="obfInput" rows="8" placeholder="ã“ã“ã«Luaã‚³ãƒ¼ãƒ‰ã‚’è²¼ã‚Šä»˜ã‘ã‚‹ã‹ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚“ã§ãã ã•ã„..."></textarea>
    </div>

    <div class="card">
      <div class="card-label">[ 02 ] ENCRYPTION LAYERS</div>
      <div class="range-row">
        <span style="font-size:.82em;color:#888">Base64å±¤æ•°</span>
        <input type="range" id="b64Layers" min="1" max="50" value="5">
        <span class="range-val" id="layerVal">5</span>
      </div>
      <div id="layerWarning" class="warn" style="display:none">âš ï¸ 30å±¤ä»¥ä¸Šã¯å‡¦ç†ã«æ™‚é–“ãŒã‹ã‹ã‚Šã¾ã™</div>
      <small class="hint">æ¨å¥¨: 5ã€œ15å±¤ ï¼ æœ€å¤§50å±¤</small>
      <div class="card-label" style="margin-top:18px">[ 03 ] JUNK CODE INTENSITY</div>
      <div class="range-row">
        <span style="font-size:.82em;color:#888">ãƒ€ãƒŸãƒ¼ã‚³ãƒ¼ãƒ‰</span>
        <input type="range" id="junkIntensity" min="1" max="500" value="200">
        <span class="range-val" id="junkVal">200</span>
      </div>
      <small class="hint">æ¨å¥¨: 150ã€œ300 ï¼ æœ€å¤§500</small>
    </div>

    <div class="card">
      <div class="card-label">[ 04 ] ADVANCED OPTIONS</div>
      <div class="checks-grid">
        <label class="chk-label"><input type="checkbox" id="chkXor" checked> XORé›£èª­åŒ–</label>
        <label class="chk-label"><input type="checkbox" id="chkShuffle" checked> ã‚·ãƒ£ãƒƒãƒ•ãƒ«</label>
        <label class="chk-label"><input type="checkbox" id="chkFlat" checked> åˆ¶å¾¡ãƒ•ãƒ­ãƒ¼å¹³å¦åŒ–</label>
        <label class="chk-label" style="color:var(--obf)"><input type="checkbox" id="chkAntiDump" checked> ã‚¢ãƒ³ãƒãƒ€ãƒ³ãƒ‘ãƒ¼</label>
        <label class="chk-label" style="color:#ff9800"><input type="checkbox" id="chkSaltEncode" checked> å‹•çš„ã‚½ãƒ«ãƒˆã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰</label>
        <label class="chk-label" style="color:#ff9800"><input type="checkbox" id="chkNumExpr" checked> æ•°å€¤â†’æ•°å¼å½è£…</label>
        <label class="chk-label" style="color:#ff9800"><input type="checkbox" id="chkJunkFunc" checked> ã‚´ãƒŸé–¢æ•°æ³¨å…¥</label>
        <label class="chk-label" style="color:#00e5ff"><input type="checkbox" id="chkSplitStr" checked> æ–‡å­—åˆ—åˆ†å‰²</label>
        <label class="chk-label" style="color:#00e5ff"><input type="checkbox" id="chkConstArr"> å®šæ•°é…åˆ—åŒ–</label>
        <label class="chk-label" style="color:#00e5ff"><input type="checkbox" id="chkProxyVars"> å¤‰æ•°ProxyåŒ–</label>
        <label class="chk-label" style="color:#00e5ff"><input type="checkbox" id="chkWrapFunc" checked> é–¢æ•°ãƒ©ãƒƒãƒ—</label>
        <label class="chk-label" style="color:var(--deobf)"><input type="checkbox" id="chkLite"> è»½é‡åŒ–ãƒ¢ãƒ¼ãƒ‰</label>
        <!-- Prometheusé€£æº -->
        <label class="chk-label" style="color:#bb86fc"><input type="checkbox" id="chkPEncStr"> [P] EncryptStrings</label>
        <label class="chk-label" style="color:#bb86fc"><input type="checkbox" id="chkPConstArr"> [P] ConstantArray</label>
        <label class="chk-label" style="color:#bb86fc"><input type="checkbox" id="chkPSplitStr"> [P] SplitStrings</label>
        <label class="chk-label" style="color:#bb86fc"><input type="checkbox" id="chkPVmify"> [P] Vmify (VMåŒ–)</label>
      </div>
      <div class="lite-info" id="liteModeInfo">è»½é‡åŒ–ãƒ¢ãƒ¼ãƒ‰: ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºã‚’è‡ªå‹•çš„ã«å°ã•ãã—ã¾ã™</div>
      <div class="prometheus-hint">[P] = <span>Prometheusé€£æºæ©Ÿèƒ½</span>ï¼ˆè¦: server.jsèµ·å‹• + Luaã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« + prometheusãƒ•ã‚©ãƒ«ãƒ€ï¼‰</div>
    </div>

    <!-- Prometheusãƒ—ãƒªã‚»ãƒƒãƒˆï¼ˆ[P]é¸æŠæ™‚ã«è¡¨ç¤ºï¼‰ -->
    <div class="card" id="prometheusCard" style="display:none">
      <div class="card-label">[ 05 ] PROMETHEUS PRESET</div>
      <select class="styled-select" id="obfPreset">
        <option value="Weak">Weak</option>
        <option value="Medium" selected>Medium</option>
        <option value="Strong">Strong</option>
      </select>
      <small class="hint" style="margin-top:8px">Prometheusã‚¹ãƒ†ãƒƒãƒ—ãŒæœ‰åŠ¹ãªå ´åˆã«é©ç”¨ã•ã‚Œã¾ã™</small>
    </div>

    <button class="main-btn" id="btnObfuscate">âš¡ é›£èª­åŒ–ã‚’å®Ÿè¡Œ</button>
    <div class="progress-wrap" id="obfProgress"><div class="progress-fill" id="obfProgressFill"></div></div>
    <div class="status-line" id="obfStatus" style="color:#4db6ac">READY</div>

    <div class="card">
      <div class="card-label" id="obfOutLabel">[ 06 ] OUTPUT</div>
      <textarea id="obfOutput" rows="8" readonly placeholder="é›£èª­åŒ–ã•ã‚ŒãŸã‚³ãƒ¼ãƒ‰ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™..."></textarea>
      <button class="copy-btn" id="btnObfCopy">ğŸ“‹ ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼</button>
    </div>
  </div>

  <!-- â•â• è§£èª­ãƒ‘ãƒãƒ« â•â• -->
  <div class="tool-panel deobf-panel" id="panelDeobf">
    <div class="info-banner">
      <strong>Multi-Layer Deobfuscator</strong> â€” è¤‡æ•°ã®é›£èª­åŒ–ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’è‡ªå‹•æ¤œå‡ºã—ã¦è§£é™¤ã—ã¾ã™ã€‚<br>
      âœ¨ XOR / Base64 / EncryptStrings / ConstantArray / SplitStrings / Vmify å¯¾å¿œ &nbsp;ï½œ&nbsp; ğŸ” å¤šæ®µéšè§£èª­ãƒ¢ãƒ¼ãƒ‰ä»˜ã
    </div>

    <div class="card">
      <div class="card-label">[ 01 ] DEOBFUSCATION METHOD</div>
      <div class="method-grid" id="methodGrid">
        <label class="method-card selected" data-val="auto">
          <input type="radio" name="deobfMethod" value="auto" checked>
          <div class="method-card-title">ğŸ¤– AUTO</div>
          <div class="method-card-desc">å…¨æ‰‹æ³•ã‚’è‡ªå‹•ã§è©¦è¡Œï¼ˆæ¨å¥¨ï¼‰</div>
        </label>
        <label class="method-card" data-val="xor">
          <input type="radio" name="deobfMethod" value="xor">
          <div class="method-card-title">ğŸ”‘ XOR</div>
          <div class="method-card-desc">æ™‚é–“ãƒ™ãƒ¼ã‚¹XORæš—å·</div>
        </label>
        <label class="method-card" data-val="split_strings">
          <input type="radio" name="deobfMethod" value="split_strings">
          <div class="method-card-title">âœ‚ï¸ SPLIT</div>
          <div class="method-card-desc">æ–‡å­—åˆ—åˆ†å‰²ã‚’çµåˆ</div>
        </label>
        <label class="method-card" data-val="encrypt_strings">
          <input type="radio" name="deobfMethod" value="encrypt_strings">
          <div class="method-card-title">ğŸ” ENCRYPT</div>
          <div class="method-card-desc">string.char/hexå¾©å·</div>
        </label>
        <label class="method-card" data-val="constant_array">
          <input type="radio" name="deobfMethod" value="constant_array">
          <div class="method-card-title">ğŸ“¦ ARRAY</div>
          <div class="method-card-desc">å®šæ•°é…åˆ—ã‚’å±•é–‹</div>
        </label>
        <label class="method-card" data-val="vmify">
          <input type="radio" name="deobfMethod" value="vmify">
          <div class="method-card-title">ğŸ–¥ï¸ VMIFY</div>
          <div class="method-card-desc">VMé›£èª­åŒ–ã‚’é™çš„è§£æ</div>
        </label>
      </div>
    </div>

    <div class="card">
      <div class="card-label">[ 02 ] IMPORT OBFUSCATED CODE</div>
      <label for="deobfFileInput" class="file-btn">ğŸ“‚ é›£èª­åŒ–æ¸ˆã¿ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠ (.lua / .txt)</label>
      <input type="file" id="deobfFileInput" accept=".lua,.txt">
      <div id="deobfFileName" class="file-name">ãƒ•ã‚¡ã‚¤ãƒ«æœªé¸æŠ</div>
      <textarea id="deobfInput" rows="8" placeholder="é›£èª­åŒ–ã•ã‚ŒãŸLuaã‚³ãƒ¼ãƒ‰ã‚’è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„..."></textarea>
    </div>

    <button class="main-btn" id="btnDeobfuscate">ğŸ”¬ è§£èª­ã‚’å®Ÿè¡Œ</button>
    <div class="loader" id="deobfLoader"></div>
    <div class="status-line" id="deobfStatus" style="color:var(--deobf)">READY</div>

    <!-- ã‚¹ãƒ†ãƒƒãƒ—è§£æçµæœ -->
    <div class="step-results" id="stepResults" style="display:none">
      <div class="step-results-label">STEP ANALYSIS</div>
      <div id="stepList"></div>
    </div>

    <div class="card">
      <div class="card-label">[ 03 ] DEOBFUSCATED OUTPUT</div>
      <textarea id="deobfOutput" rows="10" readonly placeholder="è§£èª­ã•ã‚ŒãŸã‚³ãƒ¼ãƒ‰ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™..."></textarea>
      <button class="copy-btn" id="btnDeobfCopy">ğŸ“‹ ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼</button>
      <button class="use-as-input-btn" id="btnUseAsInput">â†© å‡ºåŠ›ã‚’å…¥åŠ›ã¨ã—ã¦ä½¿ã†ï¼ˆå¤šæ®µéšè§£èª­ï¼‰</button>
    </div>
  </div>
</div>

<a href="https://discord.gg/qHmudNCUJ9" target="_blank" class="discord-btn" title="Discordã‚µãƒ¼ãƒãƒ¼ã«å‚åŠ ">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 127.14 96.36">
    <path d="M107.7,8.07A105.15,105.15,0,0,0,81.47,0a72.06,72.06,0,0,0-3.36,6.83A97.68,97.68,0,0,0,49,6.83,72.37,72.37,0,0,0,45.64,0,105.89,105.89,0,0,0,19.39,8.09C2.79,32.65-1.71,56.6.54,80.21h0A105.73,105.73,0,0,0,32.71,96.36,77.7,77.7,0,0,0,39.6,85.25a68.42,68.42,0,0,1-10.85-5.18c.91-.66,1.8-1.34,2.66-2a75.57,75.57,0,0,0,64.32,0c.87.71,1.76,1.39,2.66,2a68.68,68.68,0,0,1-10.87,5.19,77,77,0,0,0,6.89,11.1A105.25,105.25,0,0,0,126.6,80.22h0C129.24,52.84,122.09,29.11,107.7,8.07ZM42.45,65.69C36.18,65.69,31,60,31,53s5-12.74,11.43-12.74S54,46,53.89,53,48.84,65.69,42.45,65.69Zm42.24,0C78.41,65.69,73.25,60,73.25,53s5-12.74,11.44-12.74S96.23,46,96.12,53,91.08,65.69,84.69,65.69Z"/>
  </svg>
</a>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  ã‚µãƒ¼ãƒãƒ¼ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function loadStatus() {
  try {
    const r = await fetch('/api/status');
    const d = await r.json();
    const dotLua = document.getElementById('dotLua'), labelLua = document.getElementById('labelLua');
    if (d.lua && d.lua !== 'not installed') { dotLua.className='srv-dot ok'; labelLua.textContent='Lua: '+d.lua; }
    else { dotLua.className='srv-dot err'; labelLua.textContent='Lua: æœªã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«'; }
    const dotP = document.getElementById('dotPrometheus'), labelP = document.getElementById('labelPrometheus');
    if (d.prometheus === 'available') { dotP.className='srv-dot ok'; labelP.textContent='Prometheus: OK'; }
    else { dotP.className='srv-dot warn'; labelP.textContent='Prometheus: æœªè¨­å®š'; }
  } catch {
    ['dotLua','dotPrometheus'].forEach(id=>document.getElementById(id).className='srv-dot warn');
    document.getElementById('labelLua').textContent='Lua: ã‚µãƒ¼ãƒãƒ¼æœªèµ·å‹•';
    document.getElementById('labelPrometheus').textContent='Prometheus: ã‚µãƒ¼ãƒãƒ¼æœªèµ·å‹•';
  }
}
loadStatus();

// Prometheus [P] ãƒã‚§ãƒƒã‚¯æ™‚ã«ãƒ—ãƒªã‚»ãƒƒãƒˆã‚«ãƒ¼ãƒ‰ã‚’è¡¨ç¤º
['chkPEncStr','chkPConstArr','chkPSplitStr','chkPVmify'].forEach(id => {
  document.getElementById(id).addEventListener('change', () => {
    const any = ['chkPEncStr','chkPConstArr','chkPSplitStr','chkPVmify'].some(i=>document.getElementById(i).checked);
    document.getElementById('prometheusCard').style.display = any ? 'block' : 'none';
  });
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  ã‚¿ãƒ–åˆ‡æ›¿
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function switchMode(mode) {
  const isObf = mode === 'obf';
  document.getElementById('btnModeObf').classList.toggle('active', isObf);
  document.getElementById('btnModeDeobf').classList.toggle('active', !isObf);
  document.getElementById('panelObf').classList.toggle('active', isObf);
  document.getElementById('panelDeobf').classList.toggle('active', !isObf);
  document.getElementById('modeIndicator').className = 'mode-indicator ' + mode;
}
document.getElementById('btnModeObf').addEventListener('click', () => switchMode('obf'));
document.getElementById('btnModeDeobf').addEventListener('click', () => switchMode('deobf'));

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  è§£èª­ãƒ¡ã‚½ãƒƒãƒ‰é¸æŠã‚«ãƒ¼ãƒ‰
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
document.querySelectorAll('.method-card').forEach(card => {
  card.addEventListener('click', () => {
    document.querySelectorAll('.method-card').forEach(c => c.classList.remove('selected'));
    card.classList.add('selected');
    card.querySelector('input').checked = true;
  });
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const byId = id => document.getElementById(id);
const sleep = ms => new Promise(r => setTimeout(r, ms));
function randomString(n) {
  const c="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_";
  let s=""; for(let i=0;i<n;i++) s+=c[Math.floor(Math.random()*c.length)]; return s;
}
function makeSalt(len) {
  const a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";
  let s=""; for(let i=0;i<len;i++) s+=a[Math.floor(Math.random()*a.length)]; return s;
}
function escHtml(s) { return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼UI
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function updateObfUI() {
  const l=parseInt(byId('b64Layers').value);
  byId('layerVal').innerText=l;
  byId('layerWarning').style.display=l>=30?'block':'none';
  byId('junkVal').innerText=byId('junkIntensity').value;
}
byId('b64Layers').addEventListener('input',updateObfUI);
byId('junkIntensity').addEventListener('input',updateObfUI);
byId('chkLite').addEventListener('change',function(){byId('liteModeInfo').style.display=this.checked?'block':'none';});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ»ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function setObfStatus(msg,type){
  const el=byId('obfStatus'); el.innerText=msg;
  el.style.color=type==='error'?'#ff3c5a':type==='process'?'#bb86fc':'#4db6ac';
}
function updateObfProgress(pct){byId('obfProgress').style.display='block';byId('obfProgressFill').style.width=pct+'%';}
function setDeobfStatus(msg,type){
  const el=byId('deobfStatus'); el.innerText=msg;
  el.style.color=type==='error'?'#ff3c5a':type==='process'?'#bb86fc':'#00e5ff';
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function handleFile(inputId,displayId,textareaId){
  const file=byId(inputId).files[0]; if(!file) return;
  byId(displayId).innerText=`é¸æŠä¸­: ${file.name} (${(file.size/1024).toFixed(1)} KB)`;
  const r=new FileReader(); r.onload=e=>{byId(textareaId).value=e.target.result;}; r.readAsText(file);
}
byId('obfFileInput').addEventListener('change',()=>handleFile('obfFileInput','obfFileName','obfInput'));
byId('deobfFileInput').addEventListener('change',()=>handleFile('deobfFileInput','deobfFileName','deobfInput'));

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  å¤‰æ•°åç”Ÿæˆ / æ•°å€¤å½è£… / ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰é–¢æ•°ç¾¤
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function generateVarName(lite){
  if(lite){const t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_";return t[Math.floor(Math.random()*t.length)];}
  const starts=["I","l","O","Il","lI","OI","IO","lO","Ol"];
  let e=starts[Math.floor(Math.random()*starts.length)];
  const chars=["I","l","O","_","1","0"];
  const len=10+Math.floor(8*Math.random());
  for(let a=0;a<len;a++) e+=chars[Math.floor(Math.random()*chars.length)];
  return e;
}
function numToExpr(n){
  const r=Math.random();
  if(r<0.25&&n>1){for(let a=2;a<=Math.min(20,n);a++){if(n%a===0)return `(${a}*${n/a})`;}}
  if(r<0.5){const off=Math.floor(Math.random()*50)+1;return `(${n+off}-${off})`;}
  if(r<0.75)return `(math.floor(${n*10}/10))`;
  const x=Math.floor(Math.random()*255)+1;return `(bit32 and bit32.bxor(${n^x},${x}) or ${n})`;
}
function strToSaltedDecimal(str){
  const salt=makeSalt(3+Math.floor(Math.random()*4));
  const offset=salt.split('').reduce((a,c)=>a+c.charCodeAt(0),0)%128;
  const codes=str.split('').map(c=>c.charCodeAt(0)-offset);
  return `(function()local _s="${salt}";local _o=0;for i=1,#_s do _o=_o+string.byte(_s,i) end;_o=_o%128;return string.char(${codes.map(v=>`_o+${v}`).join(',')})end)()`;
}
function strToSaltXor(str){
  const salt=makeSalt(4+Math.floor(Math.random()*4));
  const sc=salt.split('').map(c=>c.charCodeAt(0));
  const encoded=str.split('').map((c,i)=>c.charCodeAt(0)^sc[i%sc.length]);
  return `(function()local _k={string.byte("${salt}",1,${salt.length})};local _e={${encoded.join(',')}};local _r={};for i=1,#_e do _r[i]=string.char(bit32 and bit32.bxor(_e[i],_k[(i-1)%#_k+1]) or ((_e[i]+_k[(i-1)%#_k+1])%256)) end;return table.concat(_r) end)()`;
}
const PRIMES=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47];
function factorize(n){
  for(let i=0;i<PRIMES.length;i++)for(let j=i;j<PRIMES.length;j++)if(PRIMES[i]*PRIMES[j]===n)return `${PRIMES[i]}*${PRIMES[j]}`;
  for(let a=2;a<=15;a++){const q=Math.floor(n/a),r=n%a;if(r===0)return `${a}*${q}`;if(q>0&&q<256&&r>0)return `${a}*${q}+${r}`;}
  return String(n);
}
function strToPrimeFactored(str){return `string.char(${str.split('').map(c=>`(${factorize(c.charCodeAt(0))})`).join(',')})`;}
function rot13c(c){const code=c.charCodeAt(0);if(code>=65&&code<=90)return String.fromCharCode(((code-65+13)%26)+65);if(code>=97&&code<=122)return String.fromCharCode(((code-97+13)%26)+97);return c;}
function strToReverseRot13(str){
  const rot13ed=str.split('').reverse().map(rot13c).join('');
  const escaped=rot13ed.replace(/\\/g,'\\\\').replace(/"/g,'\\"');
  return `(function()local _e={string.byte("${escaped}",1,${rot13ed.length})};local _r={};for i=1,#_e do local c=_e[i];if c>=65 and c<=90 then c=((c-65+13)%26)+65 elseif c>=97 and c<=122 then c=((c-97+13)%26)+97 end;table.insert(_r,1,string.char(c)) end;return table.concat(_r) end)()`;
}
function strToEncodedChar(str){
  if(!str||str.length===0)return '""';
  const m=Math.floor(Math.random()*4);
  try{if(m===0)return strToSaltedDecimal(str);if(m===1)return strToSaltXor(str);if(m===2)return strToPrimeFactored(str);return strToReverseRot13(str);}
  catch(e){return strToPrimeFactored(str);}
}
function strToChar(str){const c=[];for(let i=0;i<str.length;i++)c.push(str.charCodeAt(i));return `string.char(${c.join(',')})`;}
function bytesToBase64(t){return btoa(Array.from(t,t=>String.fromCodePoint(t)).join(""));}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  ã‚´ãƒŸé–¢æ•°ãƒ»ã‚¸ãƒ£ãƒ³ã‚¯ã‚³ãƒ¼ãƒ‰
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function generateJunkFunction(lite){
  const fn=generateVarName(lite),a=generateVarName(lite),b=generateVarName(lite),c=generateVarName(lite);
  const patterns=[
    `local function ${fn}(${a},${b})local ${c}=0;for i=1,${numToExpr(Math.floor(Math.random()*10)+1)} do ${c}=${c}+${a}*i end;return ${c}+${b} end`,
    `local function ${fn}(${a})local ${b}={};for i=1,#${a} do ${b}[i]=string.byte(${a},i)+${numToExpr(Math.floor(Math.random()*10)+1)} end;return table.concat(${b},",") end`,
    `local function ${fn}(${a},${b},${c})if ${a}>${b} then return ${a}-${c} elseif ${b}>${c} then return ${b}*2 else return ${c} end end`,
    `local ${fn};do local ${a}=${numToExpr(Math.floor(Math.random()*100)+1)};local ${b}=${numToExpr(Math.floor(Math.random()*100)+1)};${fn}=function()return ${a}+${b} end end`,
  ];
  return patterns[Math.floor(Math.random()*patterns.length)]+(lite?';':';\n');
}
function generateMassiveJunkCode(count,lite,opts){
  let e="";
  const encStr=s=>(opts&&opts.useSaltEncode)?strToEncodedChar(s):strToChar(s);
  const encNum=n=>(opts&&opts.useNumExpr)?numToExpr(n):String(n);
  const patterns=[
    ()=>`local ${generateVarName(lite)}=${encNum(Math.floor(Math.random()*9999)+1)};${lite?'':'\n'}`,
    ()=>`local ${generateVarName(lite)}="${randomString(lite?8:16)}";${lite?'':'\n'}`,
    ()=>`local ${generateVarName(lite)}=${encStr(randomString(lite?4:8))};${lite?'':'\n'}`,
    ()=>`local ${generateVarName(lite)}=function()return ${encNum(Math.floor(Math.random()*100))} end;${lite?'':'\n'}`,
    ()=>`local ${generateVarName(lite)}={${Array.from({length:lite?3:5},()=>encNum(Math.floor(Math.random()*100)+1)).join(",")}};${lite?'':'\n'}`,
    ()=>`if ${Math.random()>.5}then local ${generateVarName(lite)}=nil end;${lite?'':'\n'}`,
    ()=>`for ${generateVarName(lite)}=1,${encNum(Math.floor(Math.random()*8)+2)} do end;${lite?'':'\n'}`,
    ()=>`while false do local ${generateVarName(lite)}=true;break;end;${lite?'':'\n'}`,
    ()=>`local ${generateVarName(lite)}=math.max(${encNum(Math.floor(Math.random()*50))},${encNum(Math.floor(Math.random()*50))});${lite?'':'\n'}`,
    ()=>`local ${generateVarName(lite)}=math.abs(math.floor(${(Math.random()*1000-500).toFixed(2)}));${lite?'':'\n'}`,
    ()=>`local ${generateVarName(lite)}=string.rep(${encStr(randomString(2))},${encNum(Math.floor(Math.random()*4)+2)});${lite?'':'\n'}`,
    ()=>`local ${generateVarName(lite)}=type(${encStr(randomString(3))});${lite?'':'\n'}`,
    ()=>generateJunkFunction(lite),
  ];
  for(let r=0;r<count;r++) e+=patterns[Math.floor(Math.random()*patterns.length)]();
  return e;
}
function injectJunkIntoCode(code,intensity,lite,opts){
  const encStr=s=>(opts&&opts.useSaltEncode)?strToEncodedChar(s):strToChar(s);
  const encNum=n=>(opts&&opts.useNumExpr)?numToExpr(n):String(n);
  const lines=code.split('\n'),result=[];
  for(let i=0;i<lines.length;i++){
    result.push(lines[i]);
    if(Math.random()>0.7&&intensity>50){
      const n=Math.floor(Math.random()*3)+1;
      for(let j=0;j<n;j++){
        const r=Math.random();
        if(r<0.4)result.push(`local ${generateVarName(lite)}=${encNum(Math.floor(Math.random()*999)+1)};`);
        else if(r<0.7)result.push(`local ${generateVarName(lite)}=${encStr(randomString(lite?3:6))};`);
        else result.push(generateJunkFunction(lite).replace(/\n/g,''));
      }
    }
  }
  return result.join(lite?'':'\n');
}
function minifyCode(code){
  return code.replace(/--\[\[[\s\S]*?\]\]/g,'').replace(/--[^\n]*/g,'').replace(/\n\s*\n/g,'\n').replace(/[ \t]+/g,' ').trim();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  ãƒ¡ã‚¤ãƒ³é›£èª­åŒ–å‡¦ç†
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function processObfuscation(inputCode,opts){
  const TARGET_SIZE=1.5*1024*1024;
  let a=inputCode;
  const lite=opts.useLite;
  let adjLayers=opts.layers,adjJunk=opts.junk;
  if(lite){
    const estSize=new Blob([inputCode]).size*Math.pow(1.37,opts.layers);
    if(estSize>TARGET_SIZE){
      setObfStatus("è»½é‡åŒ–: ã‚µã‚¤ã‚ºèª¿æ•´ä¸­...","process");
      adjLayers=Math.max(3,Math.floor(Math.log(TARGET_SIZE/new Blob([inputCode]).size)/Math.log(1.37)));
      adjJunk=Math.min(opts.junk,80);
      await sleep(50);
    }
  }
  const XOR_DEPTH=36;
  let xorDecoder="",vXorVar="";
  if(opts.useXor){
    setObfStatus("36å±¤ Chaos XORæš—å·åŒ–ä¸­...","process"); await sleep(20);
    const masterSeed=Math.floor(Math.random()*99999999)+100000;
    let cur=masterSeed;
    const nxt=()=>{cur=(cur*1664525+1013904223)%4294967296;return cur;};
    const ops=[];
    for(let i=0;i<XOR_DEPTH;i++){const r=nxt();ops.push({type:Math.floor((r%100)/34),keyBase:Math.floor((r/256)%255)+1,prime:[2,3,5,7,11,13,17,19,23,29,31][Math.floor((r%1000)/100)]||3});}
    const bytes=new Uint8Array(a.length);
    for(let i=0;i<a.length;i++) bytes[i]=a.charCodeAt(i);
    for(let pass=0;pass<XOR_DEPTH;pass++){
      const{type:tp,keyBase:k,prime:p}=ops[pass];
      for(let i=0;i<bytes.length;i++){const dk=(k*(i+p))%256;if(tp===0)bytes[i]=bytes[i]^dk;else if(tp===1)bytes[i]=(bytes[i]+dk)%256;else bytes[i]=(bytes[i]-dk+256)%256;}
      if(pass%5===0)updateObfProgress((pass/XOR_DEPTH)*30);
    }
    let enc="";const cs=32768;
    for(let i=0;i<bytes.length;i+=cs) enc+=String.fromCharCode.apply(null,bytes.subarray(i,i+cs));
    a=enc;
    vXorVar=generateVarName(lite);
    xorDecoder=`\nlocal function ${vXorVar}(str)\nlocal b={}\nfor i=1,#str do b[i]=string.byte(str,i) end\nlocal s=${masterSeed}\nlocal function n() s=(s*1664525+1013904223)%4294967296 return s end\nlocal ops={}\nlocal pr={2,3,5,7,11,13,17,19,23,29,31}\nfor i=1,${XOR_DEPTH} do\nlocal r=n()\nlocal t=math.floor((r%100)/34)\nlocal k=math.floor((r/256)%255)+1\nlocal p=pr[math.floor((r%1000)/100)+1] or 3\ntable.insert(ops,{t,k,p})\nend\nfor pass=${XOR_DEPTH},1,-1 do\nlocal op=ops[pass]\nlocal t,k,p=op[1],op[2],op[3]\nfor i=1,#b do\nlocal dk=(k*(i+p))%256\nif t==0 then b[i]=bit32.bxor(b[i],dk)\nelseif t==1 then b[i]=(b[i]-dk+256)%256\nelseif t==2 then b[i]=(b[i]+dk)%256 end\nend\nend\nlocal r={}\nfor i=1,#b do r[i]=string.char(b[i]) end\nreturn table.concat(r)\nend\n`;
  }
  for(let i=0;i<adjLayers;i++){
    updateObfProgress(30+(i/adjLayers)*60); if(i%5===0) await sleep(10);
    try{a=btoa(a);}catch(err){const b=new Uint8Array(a.length);for(let j=0;j<a.length;j++)b[j]=a.charCodeAt(j);a=bytesToBase64(b);}
  }
  const vLib=generateVarName(lite),vStr=generateVarName(lite),vTbl=generateVarName(lite),vVM=generateVarName(lite),vSt=generateVarName(lite),dv1=generateVarName(lite),dv2=generateVarName(lite),dv3=generateVarName(lite);
  const b64Decoder=lite
    ?`local ${dv1}='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/='local ${dv2}={}for ${dv3}=1,#${dv1} do ${dv2}[string.byte(${dv1},${dv3},${dv3})]=${dv3}-1 end local function ${vLib}(s)local r,p,n={},1,#s for i=1,n,4 do local a,b,c,d=${dv2}[string.byte(s,i,i)],${dv2}[string.byte(s,i+1,i+1)],${dv2}[string.byte(s,i+2,i+2)],${dv2}[string.byte(s,i+3,i+3)]if not a or not b then break end r[p]=string.char((a*4+math.floor(b/16))%256)p=p+1 if not c then break end r[p]=string.char(((b%16)*16+math.floor(c/4))%256)p=p+1 if not d then break end r[p]=string.char(((c%4)*64+d)%256)p=p+1 end return table.concat(r)end`
    :`local ${dv1}='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/='\nlocal ${dv2}={}\nfor ${dv3}=1,#${dv1} do ${dv2}[string.byte(${dv1},${dv3},${dv3})]=${dv3}-1 end\nlocal function ${vLib}(s)local r,p,n={},1,#s\nfor i=1,n,4 do local a,b,c,d=${dv2}[string.byte(s,i,i)],${dv2}[string.byte(s,i+1,i+1)],${dv2}[string.byte(s,i+2,i+2)],${dv2}[string.byte(s,i+3,i+3)]\nif not a or not b then break end\nr[p]=string.char((a*4+math.floor(b/16))%256)p=p+1\nif not c then break end\nr[p]=string.char(((b%16)*16+math.floor(c/4))%256)p=p+1\nif not d then break end\nr[p]=string.char(((c%4)*64+d)%256)p=p+1 end\nreturn table.concat(r)end\n`;
  let out=lite?'':'-- [[ Dynamic 36-Layer Chaos Obfuscation by YAJU ]] --\n';
  if(opts.useAntiDump){
    const a1=generateVarName(lite),a2=generateVarName(lite),a3=generateVarName(lite);
    out+=`local function ${a1}()local ${a2}=getfenv()local ${a3}=${a2}[${strToChar("getgenv")}]if ${a3} then ${a3}()[${strToChar("saveinstance")}]=nil ${a3}()[${strToChar("save_instance")}]=nil ${a3}()[${strToChar("dumpstring")}]=nil end if debug then if debug.sethook then pcall(function()debug.sethook(function()while true do end end,"c")end)end if debug.getinfo then debug.getinfo=nil end end end pcall(${a1})`+(lite?'':'\n');
  }
  if(adjJunk>0) out+=generateMassiveJunkCode(Math.floor(adjJunk/(lite?20:5)),lite,opts);
  if(opts.useJunkFunc&&!lite){const jfCount=Math.floor(adjJunk/30)+3;for(let i=0;i<jfCount;i++)out+=generateJunkFunction(lite);}
  out+=b64Decoder+(lite?'':'\n');
  if(opts.useXor&&xorDecoder) out+=lite?xorDecoder.replace(/\n/g,''):xorDecoder+'\n';
  if(opts.useShuffle){
    const chunks=[];for(let i=0;i<a.length;i+=500)chunks.push(a.substring(i,i+500));
    let arr=chunks.map((v,i)=>({v,i}));
    for(let i=arr.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[arr[i],arr[j]]=[arr[j],arr[i]];}
    const vIdx=generateVarName(lite);let tbl='{';arr.forEach(x=>{tbl+=`[${x.i+1}]="${x.v}",`;});tbl+='}';
    out+=lite?`local ${vTbl}=${tbl}local ${vStr}=""for ${vIdx}=1,${arr.length} do ${vStr}=${vStr}..${vTbl}[${vIdx}]end`:`local ${vTbl}=${tbl}\nlocal ${vStr}=""\nfor ${vIdx}=1,${arr.length} do ${vStr}=${vStr}..${vTbl}[${vIdx}]end\n`;
  }else{out+=lite?`local ${vStr}="${a}"`:`local ${vStr}="${a}"\n`;}
  if(opts.useFlat){
    const steps=[];
    for(let i=0;i<adjLayers;i++) steps.push(`${vStr}=${vLib}(${vStr})`);
    if(opts.useXor&&vXorVar) steps.push(`${vStr}=${vXorVar}(${vStr})`);
    steps.push(`local f=loadstring(${vStr})if f then f()end return`);
    let vm='{';for(let i=0;i<steps.length;i++)vm+=`[${i}]=function()${steps[i]} return ${i===steps.length-1?-1:i+1}end,`;vm+='}';
    out+=lite?`local ${vSt}=0 local ${vVM}=${vm}while ${vSt}~=-1 do ${vSt}=${vVM}[${vSt}]()end`:`local ${vSt}=0\nlocal ${vVM}=${vm}\nwhile ${vSt}~=-1 do ${vSt}=${vVM}[${vSt}]()end`;
  }else{
    for(let i=0;i<adjLayers;i++) out+=lite?`${vStr}=${vLib}(${vStr})`:`${vStr}=${vLib}(${vStr})\n`;
    if(opts.useXor&&vXorVar) out+=lite?`${vStr}=${vXorVar}(${vStr})`:`${vStr}=${vXorVar}(${vStr})\n`;
    out+=`loadstring(${vStr})()`;
  }
  if(adjJunk>100) out=injectJunkIntoCode(out,adjJunk,lite,opts);
  if(lite) out=minifyCode(out);
  if(opts.useWrapFunc&&!lite) out=`(function()${out}\nend)()`;
  return out;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  é›£èª­åŒ–ãƒœã‚¿ãƒ³
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function startObfuscation(){
  const code=byId('obfInput').value;
  if(!code.trim()){setObfStatus("ã‚¨ãƒ©ãƒ¼: ã‚³ãƒ¼ãƒ‰ãŒç©ºã§ã™","error");return;}
  const btn=byId('btnObfuscate'); btn.disabled=true; updateObfProgress(0);
  const opts={
    layers:parseInt(byId('b64Layers').value), junk:parseInt(byId('junkIntensity').value),
    useXor:byId('chkXor').checked, useShuffle:byId('chkShuffle').checked, useFlat:byId('chkFlat').checked,
    useAntiDump:byId('chkAntiDump').checked, useSaltEncode:byId('chkSaltEncode').checked,
    useNumExpr:byId('chkNumExpr').checked, useJunkFunc:byId('chkJunkFunc').checked,
    useSplitStr:byId('chkSplitStr').checked, useConstArr:byId('chkConstArr').checked,
    useProxyVars:byId('chkProxyVars').checked, useWrapFunc:byId('chkWrapFunc').checked,
    useLite:byId('chkLite').checked,
  };
  const prometheusSteps=[];
  if(byId('chkPEncStr').checked) prometheusSteps.push('EncryptStrings');
  if(byId('chkPConstArr').checked) prometheusSteps.push('ConstantArray');
  if(byId('chkPSplitStr').checked) prometheusSteps.push('SplitStrings');
  if(byId('chkPVmify').checked) prometheusSteps.push('Vmify');
  try{
    setObfStatus("å‡¦ç†ä¸­...","process");
    let result=await processObfuscation(code,opts);
    if(prometheusSteps.length>0){
      setObfStatus("Prometheusã§è¿½åŠ é›£èª­åŒ–ä¸­...","process"); updateObfProgress(90);
      const preset=byId('obfPreset').value;
      const res=await fetch('/api/obfuscate',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({code:result,preset,steps:prometheusSteps})});
      const data=await res.json();
      if(data.success&&data.result){
        result=data.result;
        byId('obfOutLabel').textContent='[ 06 ] OUTPUT (+ Prometheus: '+prometheusSteps.join(', ')+')';
      }else{
        setObfStatus("âš ï¸ Prometheuså¤±æ•—: "+(data.error||'')+"ï¼ˆãƒ–ãƒ©ã‚¦ã‚¶å‡¦ç†çµæœã‚’ä½¿ç”¨ï¼‰","error");
        await sleep(2000);
      }
    }
    byId('obfOutput').value=result;
    const sz=new Blob([result]).size;
    const szStr=sz>=1048576?`${(sz/1048576).toFixed(2)} MB`:sz>=1024?`${(sz/1024).toFixed(2)} KB`:`${sz} bytes`;
    setObfStatus(`âœ“ å®Œäº† (${szStr})`,"success"); updateObfProgress(100);
  }catch(e){setObfStatus("ã‚¨ãƒ©ãƒ¼: "+e.message,"error");console.error(e);}
  finally{btn.disabled=false;setTimeout(()=>{byId('obfProgress').style.display='none';},2000);}
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  è§£èª­ãƒœã‚¿ãƒ³
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function startDeobfuscation(){
  const code=byId('deobfInput').value;
  if(!code.trim()){setDeobfStatus("ã‚¨ãƒ©ãƒ¼: ã‚³ãƒ¼ãƒ‰ãŒç©ºã§ã™","error");return;}
  const btn=byId('btnDeobfuscate'); btn.disabled=true;
  byId('deobfOutput').value=''; byId('deobfLoader').style.display='block';
  byId('stepResults').style.display='none'; byId('stepList').innerHTML='';
  const method=document.querySelector('input[name="deobfMethod"]:checked').value;
  setDeobfStatus(`è§£èª­ä¸­ [${method.toUpperCase()}]...`,"process");
  try{
    const res=await fetch('/api/deobfuscate',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({code,method})});
    const data=await res.json();
    if(method==='auto'&&data.steps){
      renderStepResults(data.steps);
      byId('deobfOutput').value=data.finalCode||'';
      const successCount=data.steps.filter(s=>s.success).length;
      setDeobfStatus(`âœ“ è§£èª­å®Œäº† (${successCount}/${data.steps.length} ã‚¹ãƒ†ãƒƒãƒ—æˆåŠŸ)`,successCount>0?'success':'error');
    }else if(data.success){
      byId('deobfOutput').value=data.result||data.finalCode||'';
      renderStepResults([data]); setDeobfStatus("âœ“ è§£èª­å®Œäº†ï¼","success");
    }else{
      byId('deobfOutput').value='ã‚¨ãƒ©ãƒ¼:\n'+(data.error||'ä¸æ˜ãªã‚¨ãƒ©ãƒ¼');
      renderStepResults([data]); setDeobfStatus("âŒ "+(data.error||'è§£èª­å¤±æ•—'),"error");
    }
  }catch(e){
    setDeobfStatus("âŒ ã‚µãƒ¼ãƒãƒ¼ã‚¨ãƒ©ãƒ¼: "+e.message,"error");
    byId('deobfOutput').value='-- ã‚µãƒ¼ãƒãƒ¼ã«æ¥ç¶šã§ãã¾ã›ã‚“\n-- node server.js ãŒèµ·å‹•ã—ã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„';
  }finally{btn.disabled=false;byId('deobfLoader').style.display='none';}
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  ã‚¹ãƒ†ãƒƒãƒ—çµæœãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderStepResults(steps){
  if(!steps||steps.length===0) return;
  const list=byId('stepList'); list.innerHTML='';
  steps.forEach(step=>{
    const badgeClass=step.success?'ok':'fail';
    const name=step.step||step.method||'STEP';
    const meta=[];
    if(step.key!==undefined) meta.push(`key=0x${step.key.toString(16).toUpperCase().padStart(2,'0')}`);
    if(step.score!==undefined) meta.push(`score=${step.score.toFixed(1)}`);
    if(step.preset) meta.push(`preset=${step.preset}`);
    const bodyParts=[
      step.error?`<span style="color:#ff3c5a">âŒ ${escHtml(step.error)}</span>`:'',
      step.warning?`<span style="color:#ff9800">âš ï¸ ${escHtml(step.warning)}</span>`:'',
      step.hints?step.hints.map(h=>`<div>â€¢ ${escHtml(h)}</div>`).join(''):'',
      step.strings&&step.strings.length?`<div style="margin-top:6px;color:#556070">æŠ½å‡ºæ–‡å­—åˆ— (${step.strings.length}ä»¶): ${step.strings.slice(0,8).map(s=>`<code style="color:#41e882;font-family:'Share Tech Mono',monospace;font-size:.85em">"${escHtml(s)}"</code>`).join(' ')}</div>`:'',
    ].filter(Boolean).join('');
    const item=document.createElement('div');
    item.className='step-item';
    item.innerHTML=`<div class="step-item-header" onclick="this.nextElementSibling&&this.nextElementSibling.classList.toggle('open')">
      <span class="step-badge ${badgeClass}">${step.success?'SUCCESS':'FAILED'}</span>
      <span class="step-name">${escHtml(name.toUpperCase())}</span>
      ${meta.length?`<span class="step-meta">${meta.join(' | ')}</span>`:''}
    </div>
    ${bodyParts?`<div class="step-item-body">${bodyParts}</div>`:''}`;
    list.appendChild(item);
  });
  byId('stepResults').style.display='block';
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  å¤šæ®µéšè§£èª­: å‡ºåŠ›â†’å…¥åŠ›
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
byId('btnUseAsInput').addEventListener('click',()=>{
  const val=byId('deobfOutput').value;
  if(!val||val.startsWith('ã‚¨ãƒ©ãƒ¼:')||val.startsWith('--')) return;
  byId('deobfInput').value=val;
  byId('deobfOutput').value='';
  byId('stepResults').style.display='none';
  setDeobfStatus("â†© å…¥åŠ›ã«ã‚»ãƒƒãƒˆã—ã¾ã—ãŸã€‚å†åº¦è§£èª­ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚","process");
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  ã‚¤ãƒ™ãƒ³ãƒˆç™»éŒ²
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
byId('btnObfuscate').addEventListener('click',startObfuscation);
byId('btnDeobfuscate').addEventListener('click',startDeobfuscation);
byId('btnObfCopy').addEventListener('click',()=>{byId('obfOutput').select();document.execCommand('copy');setObfStatus('ğŸ“‹ ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼','success');});
byId('btnDeobfCopy').addEventListener('click',()=>{byId('deobfOutput').select();document.execCommand('copy');setDeobfStatus('ğŸ“‹ ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼','success');});
</script>
</body>
</html>
